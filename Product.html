<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Botiga de Jocs | Inici</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f4f4; }
    header { display:flex; justify-content: space-between; align-items:center; padding:10px 20px; background:#ff5e5e; color:#fff; }
    header .logo { font-size:1.5em; font-weight:bold; }
    nav ul { list-style:none; display:flex; gap:15px; margin:0; padding:0; }
    nav ul li a { color:#fff; text-decoration:none; font-weight:bold; }
    section { padding:40px 20px; text-align:center; }
    h2 { margin-bottom:20px; }
    .btn { display:inline-block; padding:10px 20px; background-color:#ff5e5e; color:#fff; text-decoration:none; border-radius:5px; }
    .hero { background:#ffe5e5; padding:60px 20px; }
    .hero h1 { font-size:2em; margin-bottom:10px; }
    .hero p { font-size:1.2em; margin-bottom:20px; }
    .qui-som { background:#fff; padding:20px; margin-top:40px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); max-width:800px; margin-left:auto; margin-right:auto; text-align:left; }
    .qui-som h2 { text-align:center; }
    .mvv { display:flex; flex-wrap:wrap; gap:20px; justify-content:center; margin-top:20px; }
    .mvv div { background:#fff; padding:20px; border-radius:8px; width:250px; box-shadow:0 2px 6px rgba(0,0,0,0.1); text-align:left; }
    .mvv h3 { margin-bottom:10px; }
    footer { text-align:center; padding:20px; background:#ff5e5e; color:#fff; margin-top:40px; }
  </style>
</head>
<body>
  <header>
    <div class="logo">ðŸŽ´ Botiga de Jocs</div>
    <nav>
      <ul>
        <li><a href="index.html">Inici</a></li>
        <li><a href="cataleg.html">CatÃ leg</a></li>
        <li><a href="contacte.html">Contacte</a></li>
        <li><a href="cart.html">Carret (<span id="cart-count">0</span>)</a></li>
        <li><a href="politica.html">PolÃ­tiques</a></li>
        <li><a href="enviaments.html">Enviaments</a></li>
        <li><a href="mapa.html">Mapa</a></li>
        <li><a href="accessoris.html">Accessoris</a></li>
        <li><a href="blog.html">Blog</a></li>
      </ul>
    </nav>
  </header>
  <script>
  // Function to get cart from localStorage
  function getCart() {
    return JSON.parse(localStorage.getItem("cart") || "[]");
  }

  // Function to update the cart count
  function updateCartCount() {
    const cart = getCart();
    const count = cart.reduce((sum, item) => sum + item.qty, 0);
    const counter = document.getElementById("cart-count");
    if (counter) counter.textContent = count;
  }

  // Initial count
  updateCartCount();

  // Listen for changes in other tabs
  window.addEventListener('storage', updateCartCount);

  // Global function to add product (works with your cart.js)
  function addToCart(id, qty = 1) {
    let cart = getCart();
    const existing = cart.find(item => item.id === id);
    if (existing) {
      existing.qty += qty;
    } else {
      // Find product info from products array
      const product = window.products.find(p => p.id === id);
      if (!product) return;
      cart.push({ ...product, qty });
    }
    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartCount(); // âœ… update counter immediately
  }

  // Global function to remove item
  function removeFromCart(id) {
    let cart = getCart();
    cart = cart.filter(item => item.id !== id);
    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartCount();
  }

  // Clear cart globally
  function clearCart() {
    localStorage.removeItem("cart");
    updateCartCount();
  }
</script>


  <section class="product-detail" id="product-detail">
    <!-- Product info will be injected here -->
  </section>

  <footer>
    <p>Â© 2025 Botiga de Jocs â€” Tots els drets reservats</p>
  </footer>

  <script src="js/products.js"></script>
  <script src="js/cart.js"></script>
  <script>
    // Get product ID from URL
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");
    const product = PRODUCTS[id];

    const container = document.getElementById("product-detail");

    if (product) {
      container.innerHTML = `
        <img src="${product.img}" alt="${product.title}">
        <div class="product-info">
          <h2>${product.title}</h2>
          <p>${product.desc}</p>
          <p><strong>Preu:</strong> â‚¬${product.price.toFixed(2)}</p>
          <button id="add-cart-btn">Afegir al Carret</button>
        </div>
      `;

      document.getElementById("add-cart-btn").addEventListener("click", () => {
        addToCart(id, 1);  // id and quantity
        updateCartCount();
        alert(`${product.title} afegit al carret!`);
      });
    } else {
      container.innerHTML = "<p>Producte no trobat.</p>";
    }

    // Update cart count in header
    function updateCartCount() {
      const count = getCart().reduce((sum, item) => sum + item.qty, 0);
      document.getElementById("cart-count").textContent = count;
    }

    updateCartCount();
  </script>
</body>
</html>
